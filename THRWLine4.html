<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Tu Canasta</title>
  <link rel="stylesheet" href="style4.css">
</head>
<body>

  <div id="header"></div>
  <script>
    fetch("header.html")
      .then(res => res.text())
      .then(data => {
        document.getElementById("header").innerHTML = data;
      });
  </script>

  
   <div class="canasta">
    <h1>TU CANASTA</h1>
    <div id="lista-productos"></div>
    <div id="resumen-final"></div>
         </div>

          <script>
    const listaProductos = document.getElementById("lista-productos");
    const resumenFinal = document.getElementById("resumen-final");

    function mostrarCanasta() {
        const carrito = JSON.parse(localStorage.getItem('cestaProductos')) || [];
        listaProductos.innerHTML = "";
        resumenFinal.innerHTML = "";

        if (carrito.length === 0) {
            listaProductos.innerHTML = "<p>Tu canasta está vacía.</p>";
            return;
        }

        let totalGeneral = 0;

        carrito.forEach(producto => {
            const subtotal = producto.precio * producto.cantidad;
            const envio = subtotal >= 500 ? 0 : 100;
            const total = subtotal + envio;
            totalGeneral += total;

            const div = document.createElement("div");
            div.classList.add("producto");
            div.innerHTML = `
            <img src="${producto.imagen}" alt="${producto.nombre}">
            <div class="info">
                <h2>${producto.nombre}</h2>
                <p>Talla: ${producto.talla}</p>
                <p>Cantidad: 
                    <input type="text" value="${producto.cantidad}" 
                    class="cantidad" 
                    oninput="this.value = this.value.replace(/[^0-9]/g,'')">
                </p>
                <p>Llega el jueves 25 de septiembre</p>
            </div>
            <div class="resumen">
                <p>Subtotal: $${subtotal.toFixed(2)}</p>
                <p>Gastos de envío: $${envio.toFixed(2)}</p>
                <p class="total">Total: $${total.toFixed(2)}</p>
                <button_1 onclick="pagarAhora()">PAGAR</button_1>
            </div>
            `;
            listaProductos.appendChild(div);
        });

        
        resumenFinal.innerHTML = `
            <hr>
            <h3 style="text-align:right;">Total general: $${totalGeneral.toFixed(2)} MXN</h3>
            <div style="text-align:right; display: flex; justify-content: flex-end; gap: 10px; margin-top: 15px;">
                <button_1 onclick="pagarAhora()" style="font-weight: bold; background-color: #007bff; color: white; border: none; padding: 10px 20px; cursor: pointer;">PAGAR TODO</button_1>
                <button_1 onclick="vaciarCanasta()">Vaciar Canasta</button_1>
            </div>
        `;
    }

    function vaciarCanasta() {
        localStorage.removeItem('cestaProductos');
        mostrarCanasta();
        alert("Canasta vaciada correctamente.");
    }

    function pagarAhora() {
        alert("Redirigiendo al pago...");
        window.location.href = "THRWLine3.html";
    }

    mostrarCanasta();
</script>

</body>
</html>
